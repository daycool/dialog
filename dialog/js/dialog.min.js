(function(f){var h=window.izp=window.izp||{};h.dialog={};var e={};e.win=window;e.doc=document;e.docElem=e.doc.documentElement;e.isSetCapture="setCapture" in e.docElem;e.isLoseCapture="onlosecapture" in e.docElem;e.isIE=!-[1,];e.isIE6=e.isIE&&!e.win.XMLHttpRequest;e.lang={confirm:"\u786e\u5b9a",cancel:"\u53d6\u6d88",close:"\u5173\u95ed",tips:"\u63d0\u793a",loading:"\u52a0\u8f7d\u4e2d",succ:"\u6210\u529f",warn:"\u8b66\u544a",error:"\u9519\u8bef",isConfirm:"\u60a8\u786e\u5b9a\u5417\uff1f"};if(h.dialog&&h.dialog.lang){e.lang=h.dialog.lang}g("dialog");f.fn.dialog=function(i){i=i||{};i.follow=this[0];return f.dialog(i)};f.dialog=function(k){var j,i;k=k||{};i=f(k.follow)[0];if(j=k.noRepeatId&&f(e.doc).data("noRepeatId_"+k.noRepeatId)){return j}if(i&&f.data(i,"dialog")){return j.follow(i)}j=new b().init(k);if(k.noRepeatId){f(e.doc).data("noRepeatId_"+k.noRepeatId,j)}if(i){f.data(i,"dialog",j)}return j};function b(){this.setting={};this._defaultConfig={id:parseInt(Math.random()*100000),icon:"",title:"izp Dialog",content:"",btn:{ok:{val:e.lang.confirm,callback:function(i){this.close()},isShow:true},cancel:{val:e.lang.cancel,callback:function(i){this.close()},isShow:true},close:{val:"\xd7",callback:function(i){this.close()},isShow:true}},init:function(i){},minWidth:"250px",minHeight:"200px",width:"auto",height:"auto",left:"center",top:"center",padding:"20px",timeout:0,timeoutCallback:f.noop,opacity:0.5,border:10,maskColor:"#000",isMask:false,isShowLogo:true,isShowClose:true,isFixed:true,isDrag:true,isResize:true,noRepeatId:false,zIndex:2000,follow:null,esc:true,showType:"slide",showSpeed:"fast",skin:"default"};this.dialogHtml=function(i){return'						<div id="izp_dialog_'+i+'" class="izp_dialog">							<table class="izp_d_border">								  <tr>									<td class="izp_d_tl izp_d_h izp_d_w"></td>									<td class="izp_d_c izp_d_h"></td>									<td class="izp_d_tr izp_d_h izp_d_w"></td>								  </tr>								  <tr>									<td class="izp_d_ml izp_d_w"><span style=" width:10px;"></span></td>									<td class="">										<div class="izp_d_main">											<div class="izp_d_header"><span class="izp_d_title izp_d_title_logo">'+e.lang.tips+'</span><a class="izp_d_close">\xd7</a></div>											<div class="izp_d_content">											</div>											<div class="izp_d_footer">												<div class="izp_d_btn izp_d_main_btn">												</div>											</div>										</div>									</td>									<td class="izp_d_mr izp_d_w"></td>								  </tr>								  <tr>									<td class="izp_d_bl izp_d_h izp_d_w"></td>									<td class="izp_d_c izp_d_h"></td>									<td class="izp_d_br izp_d_h izp_d_w"></td>								  </tr>								</table>								</div>'}}b.listDialog=[];b.listDialogObj={};b.focus=function(i){if(i){if(b.focusObj==i){return}b.focusObj=i;b.pushDialog(i)}else{b.removeDialog(b.focusObj)}b.focusObj&&b.focusObj.dialog&&b.focusObj.dialog.css("z-index",b.zIndex++)};b.getFocusObj=function(){return b.focusObj||b.listDialog.pop()};b.pushDialog=function(i){if(i==null){return}b.listDialogObj[i.id]=i;f.each(b.listDialog,function(j){if(i.id==this.id){b.listDialog.splice(j,1);return false}});b.listDialog.push(i)};b.removeDialog=function(i){b.focusObj=null;delete b.listDialogObj[i.id];f.each(b.listDialog,function(j){if(i.id==this.id){b.listDialog.splice(j,1);return false}})};b.prototype={constructor:b,version:"1.0",init:function(j){var m=this,l=this.setting,i=this.dialog,k=null;f.extend(true,l,this._defaultConfig,j);if(f(l.follow).length>0){this.followObj=k=f(l.follow);l.isMask=false;l.isFixed=false;if(!this.followObj[0].id){this.followObj[0].id=l.id}l.id=this.followObj[0].id;l.noRepeatId=l.id}this.id="izp_dialog"+l.id;this.eventNamespace="."+this.id;f("body").append(this.dialogHtml(l.id));this.dialog=i=f("#izp_dialog_"+l.id);this.mainContainer=i.find(".izp_d_main");this.contentContainer=i.find(".izp_d_content");this.titleContainer=i.find(".izp_d_title");this.btnContainer=i.find(".izp_d_btn");this.headerContainer=i.find(".izp_d_header");this.footerContainer=i.find(".izp_d_footer");this.XcloseContainer=i.find(".izp_d_close");this.title(l.title);this.content(l.content,l.icon);this.border(l.border);this.buttonsInit();this.cssInit();this.logo(l.isShowLogo);this.Xclose(l.isShowClose);this.drag(l.isDrag);this.timeout(l.timeout);this.follow(k);this.setMask(l.isMask);this.ie6Mask(i.css("width"),i.css("height"),i);this.eventHandle();b.focus(m);l.init(m)},title:function(i){this.titleContainer.html(i)},content:function(j,i){j=this.getContent(j);this.contentContainer.html(j);if(i){this.contentContainer.prepend('<span class="izp_d_icon izp_d_icon_'+i+'"></span>')}},getContent:function(i){if(i==""){return""}if(f.type(i)=="number"){return""+i}else{if(f.type(i)=="object"&&(i.nodeType==1||i[0].nodeType==1)){i=f(i).clone().wrap("<div></div>").parent().html();return i}else{if(i.indexOf("id:")==0){return f(i.substring(3)).clone().wrap("<div></div>").parent().html()}else{if(i.indexOf("iframe:")==0){return'<iframe width="100%" height="100%" src='+i.substring(7)+"></iframe>"}else{return i}}}}},border:function(i){i==10?"":this.dialog.find(".izp_d_w").css("width",i).end().find(".izp_d_h").css("height",i)},cssInit:function(){var i=this.dialog,j=this.setting;this.size(j.width,j.height);this.contentContainer.css("padding",j.padding);if(j.icon){this.contentContainer.css({"padding-left":parseInt(this.contentContainer.css("padding-left"))+30+"px"})}if(j.isFixed===true&&!e.isIE6){i.css("position","fixed")}this.position(j.left,j.top);i.css("z-index",this.index())},size:function(n,l){var m=this.dialog,j=f(e.win).width(),k=f(e.win).height(),i=parseInt(this.setting.minWidth),q=parseInt(this.setting.minHeight),p,o;if(f.type(n)=="string"&&n.lastIndexOf("%")==n.length-1){p=j-(m.width()-this.mainContainer.width());n=parseInt(n)*p/100}if(f.type(l)=="string"&&l.lastIndexOf("%")==l.length-1){o=k-(m.height()-this.contentContainer.height());l=parseInt(l)*o/100}n=n<i?i:n;l=l<q?q:l;this.contentContainer.css({width:n,height:l})},position:function(j,q){j=j||t.left;q=q||t.top;var n={left:"0%",right:"100%",top:"0%",bottom:"100%",center:"50%"},p=this.dialog,t=this.setting,k=t.isFixed,l=f(e.win).width(),m=f(e.win).height(),i=f(e.doc).scrollLeft(),s=f(e.doc).scrollTop(),r=p.outerWidth(),o=p.outerWidth();j=n[j]?n[j]:j;q=n[q]?n[q]:q;if(f.type(j)=="string"&&j.lastIndexOf("%")==(j.length-1)){j=parseInt(j)*(l-r)/100;j=k?j:j+i}j=parseInt(j);if(f.type(q)=="string"&&q.lastIndexOf("%")==(q.length-1)){q=parseInt(q)*(m-o)/100;q=k?q:q+s}q=parseInt(q);(e.isIE6&&t.isFixed)?this.ie6Fixed(p,t.isFixed,q,j):p.css({left:j,top:q})},index:function(){b.zIndex=b.zIndex||1900;return b.zIndex++},logo:function(i){i===false?this.titleContainer.removeClass("izp_d_title_logo"):""},Xclose:function(i){i===false?this.XcloseContainer.hide():""},drag:function(i){i===true?this.dragInit():""},resize:function(i){i===true?this.dialog.find(".izp_d_br").css("cursor","se-resize"):""},lock:function(){this.setting.isMask=true;this.setMask(this.setting.isMask)},unlock:function(){this.hideMask(this.setting.isMask)},setMask:function(j){if(!j){return}if(this.maskContainer){this.showMask(j);return}var i="",l=this.setting,k=e.isIE?"filter:alpha(opacity="+l.opacity*100+")":"opacity:"+l.opacity;if(e.isIE6){k+=";position:absolute;width:expression(document.documentElement.clientWidth);height:expression(document.documentElement.clientHeight)";i+='<iframe class="izp_d_mask_iframe" style=" position:absolute;left:0;top:0;filter:alpha(opacity=0);z-index:-1;width:100%;height:100%;"></iframe>'}i='<div class="izp_d_mask izp_d_mask_yes" style="'+k+";background:"+l.maskColor+'">'+i+"</div>";this.maskContainer=f(i);this.dialog.before(this.maskContainer)},removeMask:function(i){if(!i){return}this.maskContainer&&this.maskContainer.remove()},hideMask:function(i){if(!i){return}this.maskContainer&&this.maskContainer.hide()},showMask:function(i){if(!i){return}this.maskContainer&&this.maskContainer.show()},buttonsInit:function(){var k=this,j=this.setting.btn,i=false;f.each(j,function(l,m){if(m===false){return true}else{if(l=="close"){k.XcloseContainer.text(this.val).click(function(){if(j[l].callback.call(k,this)){k.close()}});return true}else{f('<button class="aui_state_highlight">').text(this.val).prependTo(k.btnContainer).click(function(){if(j[l].callback.call(k,this)){k.close()}})}}i=true});!i&&k.footerContainer.hide()},dragInit:function(){var i=this;this.headerContainer.mousedown(function(j){i.dragStart(j)});f(e.doc).on("mousemove"+this.eventNamespace,function(j){i.dragMove(j)});f(e.doc).on("mouseup"+this.eventNamespace,function(j){i.dragEnd(j)})},dragStart:function(j){var i=this;i.headerContainer.addClass("izp_d_header_drag");i.dragData={dragFlag:true,dialogX:parseInt(i.dialog.css("left")),dialogY:parseInt(i.dialog.css("top")),mouseX:j.clientX,mouseY:j.clientY,mouseCurrX:j.clientX,mouseCurrY:j.clientY,min_x:0,min_y:0,max_x:f(e.doc).width()-i.dialog.width(),max_y:f(e.doc).height()-i.dialog.height()};if(e.isIE6){i.dragData.max_x-=e.docElem.offsetWidth-e.docElem.clientWidth}if(e.isLoseCapture){i.headerContainer[0].attachEvent("onlosecapture",function(){i.dragEnd()})}else{f(e.win).on("blur",function(){i.dragEnd()})}e.isSetCapture&&i.headerContainer[0].setCapture()},dragMove:function(l){var k=this,j=k.dragData;if(!j||(j&&j.dragFlag===false)){return}e.win.getSelection?e.win.getSelection().removeAllRanges():e.doc.selection.empty();var p=0,m=0,o=j.min_x,n=j.min_y,i=j.max_x,q=j.max_y;j.mouseCurrX=l.clientX;j.mouseCurrY=l.clientY;p=j.mouseCurrX-j.mouseX+j.dialogX;m=j.mouseCurrY-j.mouseY+j.dialogY;p=p<o?o:p>i?i:p;m=m<n?n:m>q?q:m;e.isIE6?this.ie6Fixed(k.dialog,k.setting.isFixed,m-f(e.doc).scrollTop(),p-f(e.doc).scrollLeft()):k.dialog.css({left:p,top:m})},dragEnd:function(j){var i=this;i.headerContainer.removeClass("izp_d_header_drag");if(i.dragData){i.dragData.dragFlag=false}if(e.isLoseCapture){}else{f(e.win).off("blur")}e.isSetCapture&&i.headerContainer[0].releaseCapture()},follow:function(l){var i;if(f.type(l)=="null"){return}i=f(l);if(i.size()<=0){return}if(i.is(":hidden")){this.position();return}var p=this,r=p.dialog,y=p.setting,n=i.offset().top,v=i.offset().left,w=i.width(),t=i.height(),q=r.width(),m=r.height(),u=f(e.win).width(),o=f(e.win).height(),j=f(e.doc).scrollLeft(),x=f(e.doc).scrollTop(),s=n+t+10,k=(v+w/2)-q/2+10;if(s+m-x>o){s=n-m-10}if(k+q-j>u){k=u-q}else{if(k<0){k=0}}r.css({top:s+"px",left:k+"px"})},timeout:function(j,i){if(j==0){return}i=i||this.setting.timeoutCallback||f.noop;var k=this;if(k.thread){clearTimeout(k.thread)}k.thread=setTimeout(function(){k.close();i()},j*1000)},show:function(){this.showMask(this.setting.isMask);this.dialog.show()},hide:function(){this.hideMask(this.setting.isMask);this.dialog.hide()},close:function(){this.removeMask(this.setting.isMask);this.dialog.remove();if(this.setting.follow){f.data(this.setting.follow,"dialog",null)}if(this.setting.noRepeatId){f(e.doc).data("noRepeateId_"+this.setting.noRepeatId,null)}this.dialog=null;if(this.dragData){this.dragData.dragFlag=false}f(e.win).off(this.eventNamespace);f(e.doc).off(this.eventNamespace);b.focus()},ie6Fixed:function(i,l,k,j){$elem=f(i);if(e.isIE6&&l===true){j=j||parseInt($elem.css("left"));k=k||parseInt($elem.css("top"));$elem[0].style.setExpression("top","eval(document.documentElement.scrollTop + "+k+') + "px"');$elem[0].style.setExpression("left","eval(document.documentElement.scrollLeft + "+j+') + "px"')}},ie6Mask:function(k,i,j){var l=f('<iframe frameborder="0" style=" position:absolute;left:0;top:0;filter:alpha(opacity=0);z-index:-1;width:100%;height:100%;"></iframe>');l.css({width:k,height:i});j=j||"body";f(j).append(l)},eventHandle:function(){var j=this,i=this.dialog;if(this.setting.esc){f(e.doc).on("keydown"+this.eventNamespace,function(k){if(k.keyCode==27&&b.focusObj==j){if(j.escThread){clearTimeout(j.escThread)}j.escThread=setTimeout(function(){j.XcloseContainer.click()},50)}})}f(e.win).on("resize"+this.eventNamespace,function(k){if(j.winResizeThread){clearTimeout(j.winResizeThread)}j.winResizeThread=setTimeout(function(){j.winResize()},30)});i.mousedown(function(){b.focus(j)})},winResize:function(){if(e.isIE6){var i=f(e.win).width()*f(e.win).height();this.winSize=this.winSize||i;if(this.winSize==i){return}this.winSize=i}var j=this.setting;this.size(j.width,j.height);this.position(j.left,j.top);this.follow(this.followObj)}};var d=b.prototype,c;f.each(d,function(j,i){if(f.type(i)=="function"){d[j]=function(){c=i.apply(this,arguments);if(f.type(c)==="undefined"){return this}else{return c}}}});f.dialog.alert=function(i){return f.dialog({content:i,btn:{cancel:false}})};f.dialog.confirm=function(j,k){j=j||"";var i=f.dialog({content:j,icon:"ques",title:e.lang.isConfirm,btn:{ok:{callback:function(){i.close();k()}}}});return i};f.dialog.succ=function(i){i=i||"";return f.dialog({content:i,icon:"succ",title:e.lang.succ,btn:{cancel:false}})};f.dialog.error=function(i){i=i||"";return f.dialog({content:i,width:"250px",icon:"error",title:e.lang.error,btn:{cancel:false}})};f.dialog.warn=function(i){i=i||"";return f.dialog({content:i,icon:"warn",title:e.lang.warn,btn:{cancel:false}})};f.dialog.loading=function(i){i=i||"";return f.dialog({content:i,icon:"loading",title:e.lang.loading,btn:{cancel:false}})};f.dialog.tip=function(l,j,i){l=l||"";j=j||2;i=i||f.noop;if(f.type(j)==="function"){callback=j;j=0}var k=f.dialog({minHeight:50,content:l,isMask:false,timeout:j,timeoutCallback:i,btn:{ok:false,cancel:false}});k.headerContainer.hide();k.footerContainer.hide();return k};function g(j){var k=a(j)+"css/"+j+".min.css",i=f("<link>");i.attr({type:"text/css",rel:"stylesheet",href:k});f("head")[0].appendChild(i[0])}function a(i){var j="";f("script").each(function(){var k=f(this).prop("src").toLowerCase();var l=k.indexOf("js/"+i+".min.js");l=l>=0?l:k.indexOf("js/"+i+".js");if(l>=0){j=k.substr(0,l);return false}});return j}})(jQuery);
